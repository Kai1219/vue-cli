"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[444],{4444:function(e,t,l){l.r(t),l.d(t,{default:function(){return De}});var a=l(6252),d=l(3577),s=l(9963);const o=(0,a._)("h2",null,"訂單列表",-1),r={class:"table table-hover align-middle"},i=(0,a._)("thead",{class:"table-secondary"},[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"訂單編號"),(0,a._)("th",{scope:"col"},"訂單日期"),(0,a._)("th",{scope:"col"},"訂購人姓名"),(0,a._)("th",{scope:"col"},"應付金額"),(0,a._)("th",{scope:"col"},"付款狀態"),(0,a._)("th",{scope:"col"},"備註"),(0,a._)("th",{scope:"col"}),(0,a._)("th",{scope:"col"})])],-1),n={scope:"row"},c={class:"form-check form-switch"},u=["onUpdate:modelValue","onChange"],p={class:"form-check-label",for:"`paidSwitch${order.id}`"},h={key:0},_={key:1},m=["onClick"],b=["onClick"];function g(e,t,l,g,w,f){const k=(0,a.up)("OrderModal"),y=(0,a.up)("DelModal"),O=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[o,(0,a._)("table",r,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(w.orders,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",n,(0,d.zw)(t.id),1),(0,a._)("td",null,(0,d.zw)(e.$filters.date(t.create_at)),1),(0,a._)("td",null,(0,d.zw)(t.user.name),1),(0,a._)("td",null,(0,d.zw)(t.final_total),1),(0,a._)("td",null,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"`paidSwitch${order.id}`","onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>f.updatePaid(t)},null,40,u),[[s.e8,t.is_paid]]),(0,a._)("label",p,[t.is_paid?((0,a.wg)(),(0,a.iD)("span",h,"已付款")):((0,a.wg)(),(0,a.iD)("span",_,"未付款"))])])]),(0,a._)("td",null,(0,d.zw)(t.user.message),1),(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e=>f.openModal(t)},"明細",8,m)]),(0,a._)("td",null,[(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:e=>f.openDelOrderModal(t)},"刪除",8,b)])])))),128))])]),(0,a.Wm)(k,{order:w.tempOrder,ref:"orderModal",onUpdatePaid:f.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(y,{order:w.tempOrder,ref:"delModal",onDelItem:f.delOrder},null,8,["order","onDelItem"]),(0,a.Wm)(O,{pages:w.pagination,onEmitPages:f.getOrders},null,8,["pages","onEmitPages"])],64)}const w={class:"modal fade",id:"OrderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog modal-xl",role:"document"},k={class:"modal-content border-0"},y=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O={class:"modal-body"},v={class:"row"},M={class:"col-md-4"},x=(0,a._)("h3",null,"用戶資料",-1),D={class:"table"},z={key:0},P=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),$=(0,a._)("th",null,"Email",-1),C=(0,a._)("th",null,"電話",-1),L=(0,a._)("th",null,"地址",-1),U={class:"col-md-8"},Z=(0,a._)("h3",null,"訂單細節",-1),E={class:"table"},H=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),V=(0,a._)("th",null,"下單時間",-1),W=(0,a._)("th",null,"付款時間",-1),Y={key:0},j={key:1},q=(0,a._)("th",null,"付款狀態",-1),I={key:0,class:"text-success"},K={key:1,class:"text-muted"},N=(0,a._)("th",null,"總金額",-1),S=(0,a._)("h3",null,"選購商品",-1),A={class:"table"},B=(0,a._)("thead",null,[(0,a._)("tr")],-1),F={class:"text-end"},G={class:"d-flex justify-content-end"},J={class:"form-check"},Q={class:"form-check-label",for:"flexCheckDefault"},R={key:0},T={key:1},X={class:"modal-footer"},ee=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function te(e,t,l,o,r,i){return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("div",f,[(0,a._)("div",k,[y,(0,a._)("div",O,[(0,a._)("div",v,[(0,a._)("div",M,[x,(0,a._)("table",D,[r.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",z,[(0,a._)("tr",null,[P,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.name),1)]),(0,a._)("tr",null,[$,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.email),1)]),(0,a._)("tr",null,[C,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.tel),1)]),(0,a._)("tr",null,[L,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",U,[Z,(0,a._)("table",E,[(0,a._)("tbody",null,[(0,a._)("tr",null,[H,(0,a._)("td",null,(0,d.zw)(r.tempOrder.id),1)]),(0,a._)("tr",null,[V,(0,a._)("td",null,(0,d.zw)(e.$filters.date(r.tempOrder.create_at)),1)]),(0,a._)("tr",null,[W,(0,a._)("td",null,[r.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",Y,(0,d.zw)(e.$filters.date(r.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",j,"時間不正確"))])]),(0,a._)("tr",null,[q,(0,a._)("td",null,[r.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",I,"已付款")):((0,a.wg)(),(0,a.iD)("span",K,"尚未付款"))])]),(0,a._)("tr",null,[N,(0,a._)("td",null,(0,d.zw)(r.tempOrder.total),1)])])]),S,(0,a._)("table",A,[B,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.tempOrder.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",null,(0,d.zw)(e.product.title),1),(0,a._)("td",null,(0,d.zw)(e.qty)+" / "+(0,d.zw)(e.product.unit),1),(0,a._)("td",F,(0,d.zw)(e.final_total),1)])))),128))])]),(0,a._)("div",G,[(0,a._)("div",J,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=e=>r.tempOrder.is_paid=e)},null,512),[[s.e8,r.tempOrder.is_paid]]),(0,a._)("label",Q,[r.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("span",R,"已付款")):((0,a.wg)(),(0,a.iD)("span",T,"未付款"))])])])])])]),(0,a._)("div",X,[ee,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=t=>e.$emit("update-paid",r.tempOrder))}," 修改付款狀態 ")])])])],512)}var le=l(1339),ae={props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},emits:["update-paid"],mixins:[le.Z],watch:{order(){this.tempOrder=this.order}}},de=l(3744);const se=(0,de.Z)(ae,[["render",te]]);var oe=se;const re={class:"modal fade",id:"delProductModal",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true",ref:"modal"},ie={class:"modal-dialog"},ne={class:"modal-content"},ce={class:"modal-header bg-danger text-white"},ue=(0,a._)("h5",{class:"modal-title",id:"delProductModalLabel"},"確定是否刪除!",-1),pe={class:"modal-body"},he=(0,a.Uk)(" 是否刪除"),_e={class:"text-danger"},me=(0,a.Uk)("?(刪除後將無法復原!!) "),be={class:"modal-footer"};function ge(e,t,l,s,o,r){return(0,a.wg)(),(0,a.iD)("div",re,[(0,a._)("div",ie,[(0,a._)("div",ne,[(0,a._)("div",ce,[ue,(0,a._)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...e)=>r.closeModal&&r.closeModal(...e)),"aria-label":"Close"})]),(0,a._)("div",pe,[(0,a._)("p",null,[he,(0,a._)("strong",_e,(0,d.zw)(l.order.user),1),me])]),(0,a._)("div",be,[(0,a._)("button",{type:"button",class:"btn btn-secondary",onClick:t[1]||(t[1]=(...e)=>r.closeModal&&r.closeModal(...e))}," 取消 "),(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[2]||(t[2]=t=>e.$emit("del-item"))},"確定刪除")])])])],512)}var we=l(7424),fe=l.n(we),ke={props:{order:{}},data(){return{}},emits:["del-item"],methods:{openModal(){console.log(this.order),this.modal.show()},closeModal(){this.modal.hide()}},mounted(){this.modal=new(fe())(this.$refs.modal)}};const ye=(0,de.Z)(ke,[["render",ge]]);var Oe=ye,ve=l(7738),Me={data(){return{orders:{},isNew:!1,pagination:{},tempOrder:{},currentPage:1}},components:{Pagination:ve.Z,DelModal:Oe,OrderModal:oe},methods:{getOrders(e=1){this.currentPage=e,this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/orders?page=${this.currentPage}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{this.isLoading=!1,alert(e.data.message)}))},openModal(e){this.tempOrder={...e},this.isNew=!1;const t=this.$refs.orderModal;t.openModal(),console.log(this)},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.openModal()},updatePaid(e){this.isLoading=!0;const t={is_paid:e.is_paid};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/order/${e.id}`,{data:t}).then((e=>{this.isLoading=!1;const t=this.$refs.orderModal;t.hideModal(),this.getOrders(this.currentPage),alert(e.data.message)})).catch((e=>{this.isLoading=!1,alert(e.data.message)}))},delOrder(){this.isLoading=!0,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/admin/order/${this.tempOrder.id}`).then((()=>{this.isLoading=!1;const e=this.$refs.delModal;e.closeModal(),this.getOrders(this.currentPage)})).catch((e=>{this.isLoading=!1,alert(e.data.message)}))}},created(){this.getOrders()}};const xe=(0,de.Z)(Me,[["render",g]]);var De=xe}}]);
//# sourceMappingURL=444.1dc00a94.js.map