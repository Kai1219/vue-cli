"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[773],{1530:function(t,e,a){function s(t){return{all:t=t||new Map,on:function(e,a){var s=t.get(e);s?s.push(a):t.set(e,[a])},off:function(e,a){var s=t.get(e);s&&(a?s.splice(s.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var s=t.get(e);s&&s.slice().map((function(t){t(a)})),(s=t.get("*"))&&s.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return i}});const l=s();var i=l},7773:function(t,e,a){a.r(e),a.d(e,{default:function(){return E}});var s=a(6252),l=a(3577),i=a(9963);const n={class:"container"},o=(0,s._)("h2",null,"購物車",-1),d={class:"table align-middle"},c=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"圖片"),(0,s._)("th",null,"商品名稱"),(0,s._)("th",null,"價格"),(0,s._)("th")])],-1),u={style:{width:"200px"}},r={key:0,class:"h5"},h={key:1},p={class:"h6"},g={class:"h5"},_={class:"btn-group btn-group-sm"},m=["onClick","disabled"],b={class:"fas fa-spinner fa-pulse"},k=(0,s.Uk)(" 查看更多 "),v=["onClick","disabled"],f={class:"fas fa-spinner fa-pulse"},w=(0,s.Uk)(" 加到購物車 "),x={class:"text-end"},C={class:"table align-middle"},y=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",null,"單價")])],-1),I=["onClick"],D={class:"fas fa-spinner fa-pulse"},L=(0,s.Uk)(" x "),z=(0,s._)("div",{class:"text-success"},"已套用優惠券",-1),$={class:"input-group input-group-sm"},U={class:"input-group mb-3"},q=["onUpdate:modelValue","onChange","disabled"],A=["value"],F={class:"input-group-text",id:"basic-addon2"},H={class:"text-end"},K=(0,s._)("small",{class:"text-success"},"折扣價：",-1),M=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),P={class:"text-end"},Y=(0,s._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),Z={class:"text-end text-success"};function T(t,e,a,T,V,j){return(0,s.wg)(),(0,s.iD)("div",n,[o,(0,s._)("table",d,[c,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(V.products,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",u,[(0,s._)("div",{style:(0,l.j5)([{backgroundImage:`url(${e.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,s._)("td",null,(0,l.zw)(e.title),1),(0,s._)("td",null,[e.origin_price===e.price?((0,s.wg)(),(0,s.iD)("div",r,(0,l.zw)(e.price)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("del",p,"原價 "+(0,l.zw)(e.origin_price)+" 元",1),(0,s._)("div",g,"現在只要 "+(0,l.zw)(e.price)+" 元",1)]))]),(0,s._)("td",null,[(0,s._)("div",_,[(0,s._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:a=>t.openProductModal(e.id),disabled:V.isLoadingItem===e.id},[(0,s.wy)((0,s._)("i",b,null,512),[[i.F8,V.isLoadingItem===e.id]]),k],8,m),(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>j.addToCart(e.id),disabled:V.isLoadingItem===e.id},[(0,s.wy)((0,s._)("i",f,null,512),[[i.F8,V.isLoadingItem===e.id]]),w],8,v)])])])))),128))])]),(0,s._)("div",x,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:e[0]||(e[0]=(...t)=>j.deleteCartAll&&j.deleteCartAll(...t))}," 清空購物車 ")]),(0,s._)("table",C,[y,(0,s._)("tbody",null,[V.cartData.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(V.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>j.deleteCartItem(t.id)},[(0,s.wy)((0,s._)("i",D,null,512),[[i.F8,V.isLoadingItem===t.id]]),L],8,I)]),(0,s._)("td",null,[(0,s.Uk)((0,l.zw)(t.product.title)+" ",1),z]),(0,s._)("td",null,[(0,s._)("div",$,[(0,s._)("div",U,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>j.updateCartItem(t),disabled:V.isLoadingItem===t.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(10,(e=>(0,s._)("option",{value:e,key:`${e}_${t.id}`},(0,l.zw)(e),9,A))),64))],40,q),[[i.bM,t.qty]]),(0,s._)("span",F,(0,l.zw)(t.product.unit),1)])])]),(0,s._)("td",H,[K,(0,s.Uk)(" "+(0,l.zw)(t.total),1)])])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[M,(0,s._)("td",P,(0,l.zw)(V.cartData.total),1)]),(0,s._)("tr",null,[Y,(0,s._)("td",Z,(0,l.zw)(V.cartData.final_total),1)])])])])}var V=a(1530),j={data(){return{cartData:{},products:[],isLoadingItem:""}},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/products/all").then((t=>{this.products=t.data.products})).catch((t=>{alert(t.data.message)}))},addToCart(t,e=1){const a={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/cart",{data:a}).then((t=>{alert(t.data.message),this.getCart()})).catch((t=>{alert(t.data.message)})),this.isLoadingItem=""},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/cart").then((t=>{this.cartData=t.data.data,V.Z.emit("get-Cart")})).catch((t=>{alert(t.data.message)}))},deleteCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/cart/${t}`).then((()=>{this.getCart()})).catch((t=>{alert(t.data.message)})),this.isLoadingItem=""},deleteCartAll(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/carts").then((()=>{this.getCart()})).catch((t=>{alert(t.data.message)}))},updateCartItem(t){const e={product_id:t.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/kate-hexschool/cart/${t.id}`,{data:e}).then((()=>{this.getCart()})).catch((t=>{alert(t.data.message)})),this.isLoadingItem="",console.log(this.cartData)}},mounted(){this.getProducts(),this.getCart()}},O=a(3744);const B=(0,O.Z)(j,[["render",T]]);var E=B}}]);
//# sourceMappingURL=773.ff0ee2e7.js.map